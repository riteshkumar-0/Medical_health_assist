<div class="container py-4">
  <!-- Page Header -->
  <div class="page-header mb-4">
    <h2 class="fw-bold">
      <i class="bi bi-file-earmark-pdf text-danger me-2"></i>Medical Document Summarizer
    </h2>
    <p class="text-muted">Upload medical PDF documents and get AI-powered structured summaries using PagePdfDocumentReader.</p>
  </div>

  <!-- Upload Section -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-body p-4">
      <h5 class="card-title fw-bold mb-4">
        <i class="bi bi-cloud-upload me-2 text-secondary"></i>Upload Document
      </h5>

      <!-- Drag & Drop Area -->
      <div class="drop-zone mb-4" [class.drag-over]="dragOver"
           (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" (drop)="onDrop($event)">
        <div *ngIf="!selectedFile" class="text-center">
          <i class="bi bi-file-earmark-pdf display-1 text-danger mb-3"></i>
          <h5 class="text-muted">Drag & Drop your PDF here</h5>
          <p class="text-muted small mb-3">or</p>
          <label class="btn btn-outline-primary btn-lg">
            <i class="bi bi-folder2-open me-2"></i>Browse Files
            <input type="file" accept=".pdf" (change)="onFileSelected($event)" class="d-none">
          </label>
          <p class="text-muted small mt-2">Supports: PDF files up to 10MB</p>
        </div>
        <div *ngIf="selectedFile" class="text-center">
          <i class="bi bi-file-earmark-check display-3 text-success mb-3"></i>
          <h5 class="fw-bold">{{ fileName }}</h5>
          <p class="text-muted">{{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>
          <button class="btn btn-outline-danger btn-sm" (click)="clearFile()">
            <i class="bi bi-x-circle me-1"></i> Remove
          </button>
        </div>
      </div>

      <!-- Options -->
      <div class="row g-3 align-items-end">
        <div class="col-md-4">
          <label class="form-label fw-semibold">Summary Type</label>
          <select class="form-select" [(ngModel)]="summaryType">
            <option value="detailed">Detailed Summary</option>
            <option value="brief">Brief Summary</option>
          </select>
        </div>
        <div class="col-md-4">
          <button class="btn btn-danger btn-lg w-100" (click)="summarize()"
                  [disabled]="loading || !selectedFile">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            <i *ngIf="!loading" class="bi bi-cpu me-2"></i>
            {{ loading ? 'Summarizing...' : 'Summarize Document' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-danger d-flex align-items-center">
    <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ error }}
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-danger" style="width: 3rem; height: 3rem;"></div>
    <p class="mt-3 text-muted">AI is reading and summarizing the document... This may take a minute.</p>
  </div>

  <!-- Summary Result -->
  <div *ngIf="summaryResult" class="card border-0 shadow-sm result-card">
    <div class="card-header bg-danger bg-opacity-10 border-0 py-3">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0 fw-bold text-danger">
          <i class="bi bi-check-circle-fill me-2"></i>Document Summary
        </h5>
        <div>
          <span class="badge bg-info me-2">{{ summaryResult.totalPages }} pages</span>
          <span class="badge bg-secondary">Template: {{ summaryResult.templateUsed }}</span>
        </div>
      </div>
    </div>
    <div class="card-body p-4">
      <div class="mb-3">
        <strong>File:</strong> {{ summaryResult.fileName }}
      </div>
      <hr>
      <div class="summary-content" [innerHTML]="summaryResult.summary | formatMarkdown"></div>
    </div>
  </div>
</div>
